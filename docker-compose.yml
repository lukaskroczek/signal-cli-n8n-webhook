services:
  signal-cli-n8n-webhook:
    image: ${IMAGE_REPO}:${APP_VERSION}
    build:
      context: .
      args:
        APP_VERSION: ${APP_VERSION}
    platform: linux/arm64
    restart: unless-stopped
    environment:
      - SIGNAL_CLI_URL=http://signal-cli-rest-api:8080
      - WEBHOOK_URL=https://your-n8n-instance/webhook/signal
      - SIGNAL_NUMBERS=+420700000000
      - POLL_INTERVAL=3
      - IGNORE_ATTACHMENTS=false
      - IGNORE_STORIES=true
      - LOG_LEVEL=INFO
    depends_on:
      - signal-cli-rest-api
  signal-cli-rest-api:
    image: bbernhard/signal-cli-rest-api:latest
    restart: unless-stopped
    environment:
      - MODE=normal
      - SIGNAL_CLI_OPTS=--config /data
    ports:
      - "8081:8081"
    volumes:
      - signal-cli-data:/data
volumes:
  signal-cli-data:
